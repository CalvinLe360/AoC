area = [
"                   |                                                                                                                                                                                     ",
"   +---+ +-------------------------------------------------------------------------------+ +-----+                       +---------------------------------------------------------------------+     +-+ ",
"   |   | |         |                                                                     | |     |                       |                                                                     |     | | ",
"   |   | |       +-------------------------------------------------------------------------|-----|-----------------------+         +-----------------------------------------------------------|-+   | | ",
"   |   | |       | |                                                                     | |     |                                 |                                                           | |   | | ",
"   |   | |       +-+   +-------------------+       +-+ +-----+                   +-------|-------------------------------+         |                                                           | |   | | ",
"   |   | |             |                   |       | | |     |                   |       | |     |                       |         |                                                           | |   | | ",
" +---+ | +---------------------------------|---+ +-|---------------------------+ |       | | +-+ |                   +-------------|-+                                         +---------------|-|---|-+ ",
" | | | |               |                   |   | | | | |     |                 | |       | | | | |                   |   |         | |                                         |               | |   |   ",
" +-+ +-----------+     |                   |   | | | +-|-----|---+ +-----+     | |       | | | | |               +-+ |   |         | |                                         |               | |   |   ",
"       |         |     |                   |   | | |   |     |   | |     |     | |       | | | | |               | | |   |         | |                                         |               | |   |   ",
"       |     +-+ +---+ |                   |   | | | +-------------------+   +-+ +-+     | | | +-|-------------------|---|------------------------------------------------L--------+           | |   |   ",
"       |     | |     | |                   |   | | | | |     |   | |         |     |     | | |   |               | | |   |         | |                                         |   |           | |   |   ",
"       |     | |     +-----------------+   |   | | | | |     |   | |         |     +-----|-|-----|---------------|-----------------+ |                                         |   |           | |   |   ",
"       |     | |       |               |   |   | | | | |     |   | |         |           | | |   |               | | |   |           |                                         |   |           | |   |   ",
"       +-----|-----+ +-----------------|-----+ | | | | |     | +-+ |   +-----|---+       | | |   |               | | |   +-----------|-+           +-------------------------+ |   |           | |   |   ",
"             | |   | | |               |   | | | | | | |     | |   |   |     |   |       | | |   |               | | |               | |           |                         | |   |           | |   |   ",
"       +-----|-----|-|-|---+       +---|---|---|---|---|---------------------------------|-|-|-------------------|-|-----+         +---+           |                         | |   |           | | +-|-+ ",
"       |     | |   | | |   |       |   |   | | | | | | |     | |   |   |     |   |       | | |   |               | | |   |         | |             |                         | |   |           | | | | | ",
"   +---------|-----|-|-|---------------+   +---|-----|-|---------------|---------|-------|---|-------+           | | |   |         | |             |                         | |   |           | | | | | ",
"   |   |     | |   | | |   |       |         | | | | | |     | |   |   |     |   |       | | |   |   |           | | |   |         | |             |                         | |   |           | | | | | ",
" +-|-+ |     | |   +---------------|---------|-|-----+ | +---|-|---|---------------------|-|---------|-----------|-+ |   +---------|-|-------------|-------------------------------+           | | | | | ",
" | | | |     | |     | |   |       |         | | | |   | |   | |   |   |     |   |       | | |   |   |           |   |             | |             |                         | |               | | | | | ",
" +-+ | | +-----------|-|---|-------|---------|-----|---+ |   | | +-+   |     | +-------------|---|---|-----------|-----+           | |           +---------+                 | |               | | | | | ",
"     | | |   | |     | |   |       |         | | | |     |   | | |     |     | | |       | | |   |   |           |   | |           | |           | |       |                 | |               | | | | | ",
"     | | |   | |     | |   |       |         | | | | +---|-------|---+ |   +---|-|---------|-|-------|-----------|---|-|-----------|-------------|---------------------------|---------+     +-----+ | | ",
"     | | |   | |     | |   |       |         | | | | |   |   | | |   | |   | | | |       | | |   |   |           |   | |           | |           | |       |                 | |       |     | | |   | | ",
"     | | |   | |     | |   |       |         | | | | |   |   | | +-P | |   | | | |       | | |   |   |           |   | |           | |           | |       |                 | |     +---------|-|-+ | | ",
"     | | |   | |     | |   |       |         | | | | |   |   | |     | |   | | | |       | | |   |   |           |   | |           | |           | |       |                 | |     | |     | | | | | | ",
" +---|-|-|---|---------|---|---+   |         | | | | |   |   | | +-+ | |   +-|-|-|-----------|-------------------------------------|-|-----------|-------+ |                 | |     | |     | | | | | | ",
" |   | | |   | |     | |   |   |   |         | | | | |   |   | | | | | |     | | |       | | |   |   |           |   | |           | |           | |     | |                 | |     | |     | | | | | | ",
" |   | | |   | |     | |   |   +---|-------------|-|-|-------|-|---|-----------|-----------|---------+           |   | |           | |           | |     | |                 | |     | |     | | | | | | ",
" |   | | |   | |     | |   |       |         | | | | |   |   | | | | | |     | | |       | | |   |               |   | |           | |           | |     | |                 | |     | |     | | | | | | ",
" |   | | |   | |     | |   |     +-|---------|---|-|-|-------|---|---|-|-----|-|-----------|---------------------|-----------------------+       | |     | |                 | |     | |     | | | | | | ",
" |   | | |   | |     | |   |     | |         | | | | |   |   | | | | | |     | | |       | | |   |               |   | |           | |   |       | |     | |                 | |     | |     | | | | | | ",
" +-----|-|---------------+ |     | |         | | | | |   |   | | | | | | +---|---|---------------|---------------------|-----------|-----|---------|---------------------------------|-|-----+ | | | | | ",
"     | | |   | |     | | | |     | |         | | | | |   |   | | | | | | |   | | |       | | |   |               |   | |           | |   |       | |     | |                 | |     | |       | | | | | ",
"     | | |   | |     | | | |     | |         | | +---|---+   | | +-|---|-|---|-|-|-------|---|-------------------|---|-------------------|---------|-----|-|-------+         | |     +-|-----+ | +-|-|-+ ",
"     | | |   | |     | | | |     | |         | |   | |       | |   | | | |   | | |       | | |   |               |   | |           | |   |       | |     | |       |         | |       |     | |   | |   ",
" +---|---------|-----|-------------|---------|-----|-|-------------|-----|-----|-------+ | | |   |               |   | |           | |   |       | |     | |       |         | |       |     | |   | |   ",
" |   | | |   | |     | | | |     | |         | |   | |       | |   | | | |   | | |     | | | |   |               |   | |           | |   |       | |     | |       |         | |       |     | |   | |   ",
" |   | | |   | | +---|-|---|-------|-----------------|-------|---------|-|---|---|---------------|---------------------|-----------|-|---|---+   | |     | |       |         | |       |     | |   | |   ",
" |   | | |   | | |   | | | |     | |         | |   | |       | |   | | | |   | | |     | | | |   |               |   | |           | |   |   |   | |     | |       |         | |       |     | |   | |   ",
" |   | | |   | | |   | | | |     | |         | |   | |       | |   | +-|-|---|-|-------|---------|-------------+ |   | |           | |   |   |   | |     | |       |         | |       |     | |   | |   ",
" |   | | |   | | |   | | | |     | |         | |   | |       | |   |   | |   | | |     | | | |   |             | |   | |           | |   |   |   | |     | |       |         | |       |     | |   | |   ",
" |   | | |   | | | +-|---|-------|-|-------------------------|-|---|---|-----|-|---------------------------------|---|-------------|-----|---+   | |     | |       |         | |   +---|---+ | |   | |   ",
" |   | | |   | | | | | | | |     | |         | |   | |       | |   |   | |   | | |     | | | |   |             | |   | |           | |   |       | |     | |       |         | |   |   |   | | |   | |   ",
" |   | | |   | | | | | | | |     | |         | |   | |       | |   |   | | +---|-|-----|---|-|---|---------------|---|-|-----------|-----|-------+ |     | |       |         | |   |   |   | | |   | |   ",
" |   | | |   | | | | | | | |     | |         | |   | |       | |   |   | | | | | |     | | | |   |             | |   | |           | |   |         |     | |       |         | |   |   |   | | |   | |   ",
" |   +-|-----|-|-|-------|-|-------|-----------|---|---------|-|---|-+ | | | | | |     | | | |   |             | |   | |           | |   |         |     | |       |         | |   |   |   | | |   | |   ",
" |     | |   | | | | | | | |     | |         | |   | |       | |   | | | | | | | |     | | | |   |             | |   | |           | |   |         |     | |       |         | |   |   |   | | |   | |   ",
" +-------|---|-|---|-|-+ | |     | |         | |   | |       | |   | +-|-----|-|-|-------|-------|---------------------------------|---------------|-------------------------|---+ |   |   | | |   | |   ",
"       | |   | | | | |   | M     | |         | |   | |       | |   |   | | | | | |     | | | |   |             | |   | |           | |   |         |     | |       |         | | | |   |   | | |   | |   ",
"       | |   | | +-|-|-+ | |     | |         | |   | |       | |   |   | +---+ | +-----|-+ | |   |             | |   | |           | |   |         |     | |       |       +---|---+   |   | | |   | |   ",
"       | |   | |   | | | | |     | |         | |   | |       | |   |   |   |   |       |   | |   |             | |   | |           | |   |         |     | |       |       | | | |     |   | | |   | |   ",
"       | |   | |   | | | +-|-----|-------------|---|---------|-----|---|-------|-------------|-----------------|-|---|-------+     | |   |         |     | |       |       | | | |     |   | | |   | |   ",
"       | |   | |   | | |   |     | |         | |   | |       | |   |   |   |   |       |   | |   |             | |   | |     |     | |   |         |     | |       |       | | | |     |   | | |   | |   ",
"       | |   | |   | | |   | +---------------+ |   | | +-----|---------|-----------+   |   | |   |             | |   | |     |     +-|---|---------------|-----------+     | | | |     |   | | |   | |   ",
"       | |   | |   | | |   | |   | |           |   | | |     | |   |   |   |   |   |   |   | |   |             | |   | |     |       |   |         |     | |       | |     | | | |     |   | | |   | |   ",
"       | |   | |   | +-|---|-|---|-------+     |   | | |     | +-------|---|-----------+   | |   |             | |   | |     |       |   |         |     | |       | |     | | | |     |   | | |   +-|-+ ",
"       | |   | |   |   |   | |   | |     |     |   | | |     |     |   |   |   |   |       | |   |             | |   | |     |       |   |         |     | |       | |     | | | |     |   | | |     | | ",
" +-----|-----|-|-----------------|-|---------------|-+ |     | +---|---|---|-------|---------|-------------------|---|-|-----|-------|---|---------|-----|-|-------|-------|-|-+ |     |   | | | +-+ | | ",
" |     | |   | |   |   |   | |   | |     |     |   |   |     | |   |   |   |   |   |       | |   |             | |   | |     |       |   |         |     | |       | |     | |   |     |   | | | | | | | ",
" |     | |   | |   |   |   | |   | | +---------|---|---------------|---|---|---|-------------|-------------------------------|-----------|---------|-----+ |       | |     | |   |     |   | | | | | | | ",
" |     | |   | |   |   |   | |   | | |   |     |   |   |     | |   |   |   |   |   |       | |   |             | |   | |     |       |   |         |       |       | |     | |   |     |   | | | | | | A ",
" |   +-+ |   | +---|-------|-------------------|-------|-----|-------------|-----+ |       | |   |             | |   | |     |       |   |         |     +-----------------|-|---|-----|-----+ | | | | | ",
" |   |   |   |     |   |   | |   | | |   |     |   |   |     | |   |   |   |   | | |       | |   |             | |   | |     |       |   |         |     | |       O |     | |   |     |   |   | | | | | ",
" |   |   |   | +---|-------|-----|---------------------------|---------|-+ |   | | |       | |   |             | |   | |     |     +-----|-------------------------|-|-----|-|---+     |   |   | | | | | ",
" |   |   |   | |   |   |   | |   | | |   |     |   |   |     | |   |   | | |   | | |       | |   |             | |   | |     |     | |   |         |     | |       | |     | |         |   |   | | | | | ",
" |   |   |   | |   |   |   | |   | | |   |     |   |   +-----|-----+   | | |   | | |       | |   |             | |   | |     |     | |   |         |     | |       | |     | |         |   |   | | | | | ",
" |   |   |   | |   |   |   | |   | | |   |     |   |         | |       | | |   | | |       | |   |             | |   | |     |     | |   |         |     | |       | |     | |         |   |   | | | | | ",
" |   |   |   | |   |   |   | |   | | |   |     |   |         | |       | | |   | | |       | |   |             | | +-|-|-------------+   |         |     | |       | |     | |     +---|---------|-+ | | ",
" |   |   |   | |   |   |   | |   | | |   |     |   |         | |       | | |   | | |       | |   |             | | | | |     |     |     |         |     | |       | |     | |     |   |   |   | |   | | ",
" |   |   |   | |   |   |   | |   | | |   |     |   |         | |       | | |   | | |       | |   |             +-----|-|---------+ |     +---------|---------------+ |     | |     |   |   |   | |   | | ",
" |   |   |   | |   |   |   | |   | | |   |     |   |         | |       | | |   | | |       | |   |               | | | |     |   | |               |     | |         |     | |     |   |   |   | |   | | ",
" +-----------|-----|---|---|-|---|-|-----+     |   |         | |     +---|-------|-|---------|-------------------|---|-|-----|---------------------------|-----------|-------+     |   |   |   | |   | | ",
"     |   |   | |   |   |   | |   | | |         |   |         | |     | | | |   | | |       | |   |               | | | |     |   | |               |     | |         |     |       |   |   |   | |   | | ",
" +-+ |   |   | |   |   +---|-----|-|-----------|---------------|-----|---|-|-------|-------|-|---|---------------|-|---|-----|---------------------+     | |         |     |       |   |   |   | |   | | ",
" | | |   |   | |   |       | |   | | |         |   |         | |     | | | |   | | |       | |   |               | | | |     |   | |                     | |         |     |       |   |   |   | |   | | ",
" | | |   |   | |   |       | |   | | |         |   |         | |     | | | |   | | |       | |   |               | | | |     |   | |                     | |         +-----|-------|---|---------|-----+ ",
" | | |   |   | |   |       | |   | | |         |   |         | |     | | | |   | | |       | |   |               | | | |     |   | |                     | |               |       |   |   |   | |   |   ",
" | | |   +---|-------------+ |   | | |         |   |         | |     | | | |   | | |       | |   |               | | | |     |   | |                     | |   +-+       +-------------|---------+   |   ",
" | | |       | |   |         |   | | |         |   |         | |     | | | |   | | |       | |   |               | | | |     |   | |                     | |   | |       | |       |   |   |   |     |   ",
" | | |       | |   |         |   | | +---------|-------------|---------|-|-------------------|---------------------|-|-------------|---------------------------|-|-----------------|---|---|-----------+ ",
" | | |       | |   |         |   | |           |   |         | |     | | | |   | | |       | |   |               | | | |     |   | |                     | |   | |       | |       |   |   |   |     | | ",
" | | |       | |   | +---+   |   | |           |   |         | |     | | | |   | | |       | |   |               +-|---|-----|---|-|---------------+     +---------------|---------|---|---+   |     | | ",
" | | |       | |   | |   |   |   | |           |   |         | |     | | | |   | | |       | |   |                 | | |     |   | |               |       |   | |       | |       |   |       |     | | ",
" | | |       | |   | |   |   |   | |           +---|---------|-|-----|-----|-----|H--------|-----------------------|---|-----|-------+             |       |   | |       | |       |   |       | +-+ | | ",
" | | |       | |   | |   |   |   | |               |         | |     | | | |   | | |       | |   |                 | | |     |   | | |             |       |   | |       | |       |   |       | | | | | ",
" | | |       | |   | |   |   |   | |         +-----------------|-------|-+ |   +-|-|-------------------------------|---------|---|-|-+             |     +---------------|---+     |   |       | | | | | ",
" | | |       | |   | |   |   |   | |         |     |         | |     | |   |     | |       | |   |                 | | |     |   | |               |     | |   | |       | | |     |   |       | | | | | ",
" | | |       | |   | |   |   |   | |     +---------|-----------|-----|-----------|---+     | |   |                 | | |     |   | |               |     | |   | |       | | |     |   |       | | | | | ",
" | | |       | |   | |   |   |   | |     |   |     |         | |     | |   |     | | |     | |   |                 | | |     |   | |               |     | |   | |       | | |     |   |       | | | | | ",
" | | |       | |   | | +-|---|---+ |     |   |     |         | |     | |   |     | | |     | |   |                 | | |     |   | |               |     | |   | |       | | |     |   |       | | | | | ",
" | | |       | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |                 | | |     |   | |               |     | |   | |       | | |     |   |       | | | | | ",
" | | |       | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |                 | | |     |   +-|---------------------|-|---------+   | | |     |   |       | | | | | ",
" | | |       | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |                 | | |     |     |               |     | |   | |   |   | | |     |   |       | | | | | ",
" | +-|-+     | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |                 | | |     |     |               |     | |   | |   +-----+ |     |   |       | | | | | ",
" |   | |     | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |                 | | |     |     |               |     | |   | |       |   |     |   |       | | | | | ",
" |   | | +---|-|---|---|-|-------------------------|---------|-------------------|---------|-----|-------------+   | | |     |   +-----------------|-------|---|-----------------------|-------|---+ | | ",
" |   | | |   | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |             |   | | |     |   | |               |     | |   | |       |   |     |   |       | |   | | ",
" |   | | |   | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |             |   | | |     | +-|-----------------|-----|-|-----------------------+   |       | |   | | ",
" |   | | |   | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |             |   | | |     | | | |               |     | T   | |       |   |         |       | |   | | ",
" |   | | +---|-|---|-|---|---|---------------|-----------------|-----|-----------|---------|-----|-------------|---|-+ |     | | | |               |     | |   | |       |   |         |       | |   | | ",
" |   | |     | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |             |   |   |     | | | |               |     | |   | |       |   |         |       | |   | | ",
" | +-+ |     +-|-------|-|---|-----|-----|---|---------------|-|-----|-----------|---------------------------------|---|-----|-----|-----------------------------|---+   |   |         |       | |   | | ",
" | |   |       |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |             |   |   |     | | | |               |     | |   | |   |   |   |         |       | |   | | ",
" | | +-------+ |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |             |   |   |   +-+ | | | +-------+     | +---+ |   | |   |   |   |         |       | |   +-+ ",
" | | | |     | |   | | | |   |     |     |   |     |         | |     | |   |     | | |     | |   |             |   |   |   |   | | | |       |     | |     |   | |   |   |   |         |       | |       ",
" | | | |     | |   | | | |   |     |     |   |     |         | |     | |   |     +-----------|---------------------------------|-+ | |       |     | |     |   | |   |   |   |         |       | |       ",
" | | | |     | |   | | | |   |     |     |   |     |         | |     | |   |       | |     | |   |             |   |   |   |   |   | |       |     | |     |   | |   |   |   |         |       | |       ",
" | | +-|-----|-|---|-|-|-|---|-----------|-------------------|-------|---------------|-------|-----------------|---|-------|---------|-----+ |     | |     +---------|---------------------------|---+   ",
" | |   |     | |   | | | |   |     |     |   |     |         | |     | |   |       | |     | |   |             |   |   |   |   |   | |     | |     | |         | |   |   |   |         |       | |   |   ",
" | |   +-------|---|-|-|-----------|---------------+ +---------------|-|---|-------|---------|-----------------+   |   |   |   |   +-----------------------------|-------+   |         |       | |   |   ",
" | |         | |   | | | |   |     |     |   |       |       | |     | |   |       | |     | |   |                 |   |   |   |     |     | |     | |         | |   |       |         |       | |   |   ",
" | |         | |   | | | |   |     |     |   |       |       | |     | |   |       | |     | |   |                 |   |   |   |     |     | |     | |         | |   |       |         |       | |   |   ",
" | |         | |   | | | |   |     |     |   |       |       | |     | |   |       | |     | |   |                 |   |   |   |     |     | |     | |         | |   |       |         |       | |   |   ",
" | |         | |   | | | |   |     |     |   | +-------------|-|-------------------|-|-------|---|-----------------|---|---|---------|-----|-|-----|-|---------------|-------|---------|-------|-|-+ |   ",
" | |         | |   | | | |   |     |     |   | |     |       | |     | |   |       | |     | |   |                 |   |   |   |     |     | |     | |         | |   |       |         |       | | | |   ",
" | | +-------------|-|-|-----------------|---|-|-----|-------|---------|---|---------|-----|-|-------------------------|---|---|-------------|-----|-----------------|-------+         |       | | | |   ",
" | | |       | |   | | | |   |     |     |   | |     |       | |     | |   |       | |     | |   |                 |   |   |   |     |     | |     | |         | |   |                 |       | | | |   ",
" | | |       | |   | | | |   |     |     |   | +-----------------------|---------+ | |     | |   |       +---------|-----------|-----|-+   | |     | |         | |   |                 |       | | | |   ",
" | | |       | |   | | | |   |     |     |   |       |       | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |                 |       | | | |   ",
" | +---+     | |   | | | |   |     |     |   |       |       | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |                 |       | | | |   ",
" |   | |     | |   | | | |   |     |     |   |       |       | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |                 |       | | | |   ",
" |   | +-------|-----+ | |   |     |     |   |       |   +-----|-----------------|-|-|-----------|---------------------|---|---------|-------------|-----------|-----|-----------------|---+   | | | |   ",
" |   |       | |   |   | |   |     |     |   |       |   |   | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |                 |   |   | | | |   ",
" |   |       | |   |   | |   |     |     |   |       |   |   | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |                 |   |   | | | |   ",
" |   |       | |   |   | |   |     |     |   |       |   |   | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |                 |   |   | | | |   ",
" |   |       | |   |   | |   | +---------|---------------------|-----|-|---|-----|-|-------|-|---------------------|---|---|-----------------|-----|-------------------------+       +-|---|-------+ |   ",
" |   |       | |   |   | |   | |   |     |   |       |   |   | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |       |       | |   |   | |   |   ",
" |   |       | |   |   | |   | |   |     |   |       |   |   | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |       |       | |   |   | |   |   ",
" |   D       | |   |   | |   | |   |     |   |       |   |   | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |       |       | |   |   | |   |   ",
" |   |       | |   |   | |   | |   |     |   |       |   |   | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |       |       | |   |   | |   |   ",
" |   |       | |   |   | |   | |   |     |   |       |   |   | |     | |   |     | | |     | |   |       |         |   |   |   |     | |   | |     | |         | |   |       |       | |   |   | |   |   ",
" |   |       | |   |   | |   | |   |     |   |       | +-----|-------------------|---------------+       |         |   |   |   |     | |   | |     | |         | |   |       |       | |   |   | |   |   ",
" |   |       | |   |   | |   | |   |     |   |       | | |   | |     | |   |     | | |     | |           |         |   |   |   |     | |   | |     | |         | |   |       |       | |   |   | |   |   ",
" |   |       | |   |   | |   | |   |     |   |       | | |   | |     | |   |     | | |     | |           |         |   |   |   |     | |   +---------|-------------------------------------|---|---+ |   ",
" |   |       | |   |   | |   | |   |     |   |       | | |   | |     | |   |     | | |     | |           |         |   |   |   |     | |     |     | |         | |   |       |       | |   |   | | | |   ",
" |   |       | |   |   | |   | |   |     |   |       | | |   | +-----|-|---------|-|-|-----|-----------------------|-------|---|-------------+     | |   +-------|-----------|-------------------|-|-|-+ ",
" |   |       | |   |   | |   | |   |     |   |       | | |   |       | |   |     | | |     | |           |         |   |   |   |     | |           | |   |     | |   |       |       | |   |   | | | | | ",
" |   |       | |   |   | |   | |   +-----+   +-+     | | |   |       | |   |     | | |     | |           |         |   |   |   |     | |           | |   |     | |   |       |       | |   |   | | +-+ | ",
" |   |       | |   |   | |   | |               |     | | |   |       | |   |     | | |     | |           |         |   |   |   |     | |           | |   |     | |   |       |       | |   |   | |     | ",
" |   |       | |   |   | |   | |               |     | | |   |       | |   |     | | |     | +---------------------|---|---|---------+ |           | |   |     | |   |     +---------|-|-+ |   | | +---+ ",
" |   |       | |   |   | |   | |               |     | | |   |       | |   |     | | |     |             |         |   |   |   |       |           | |   |     | |   |     | |       | | | |   | | |     ",
" |   |       | |   |   | |   | +-------------+ |     | | |   |       | |   |     | | |     |             +---------|-+ |   |   |       |           | |   |     | |   |     | |       | | | |   | | |     ",
" |   |       | |   |   | |   |               | |     | | |   |       | |   |     | | |     |                       | | |   |   |       |           | |   |     | |   |     | |       | | | |   | | |     ",
" |   |     +-------|-----|---|---------------------------+   |       | |   |     +---|-+   |                       | | |   |   |       |           | |   |     | |   |     | |       | | | |   | | |     ",
" |   |     | | |   |   | |   |               | |     | |     |       | |   |       | | |   |                       | | |   |   |       |           | |   |     | |   |     | |       | | | |   | | |     ",
" |   |     | | |   |   | |   |               | |     | |     |       | |   +-----+ | | |   |                       | | | +-------------------------------|-----|-----|-----|-------------|-----|---|-+   ",
" |   |     | | |   |   | |   |               | |     | |     |       | |         | | | |   |                       | | | | |   |       |           | |   |     | |   |     | |       | | | |   | | | |   ",
" |   |     | | |   |   | |   |               | |     | |     |       | |         | | | |   |                       | | | | |   |       |           | |   |     | |   |     | |       | | | |   | | | |   ",
" |   |     | | |   |   | |   |               | |     | |     |       | |         | | | |   |                       | | | | |   |       |           | |   |     | |   |     | |       | | | |   | | | |   ",
" |   | +-----|---------|---------------------|-------|-+     |       | |         | | | |   |                       | | | | |   |       |           | |   |     | |   |     | |       | | | |   | | | |   ",
" |   | |   | | |   |   | |   |               | |     |       |       | |         | | | |   |                       | | | | |   |       |           | |   |     | |   |     | |       | | | |   | | | |   ",
" |   | |   | | | +-----|-|-------------------|-|-----|-------|-+     | |         | | | |   |                       | | | +---------------+         | |   |     | |   |     | |       | | +-+   | | | |   ",
" |   | |   | | | | |   | |   |               | |     |       | |     | |         | | | |   |                       | | |   |   |       | |         | |   |     | |   |     | |       | |       | | | |   ",
" +-----|-------|---|---------|-----------+   | |     |       | |     +-|---------|-|-------|-----------------------|-|-----|-------------|-----------|----Q------|---|---------------|-|---+   | | | |   ",
"     | |   | | | | |   | |   |           |   | |     |       | |       |         | | | |   |                       | | |   |   |       | |         | |   |     | |   |     | |       | |   |   | | | |   ",
"     | |   | | | | |   | |   |           |   | |     |       | |       |         +-------------------------------+ | | |   |   |       | |         | |   |     | |   |     | |       | |   |   | | | |   ",
"     | |   | | | | |   | |   |           |   | |     |       | |       |           | | |   |                     | | | |   |   |       | |         | |   |     | |   |     | |       | |   |   | | | |   ",
"     | |   | | | | |   | |   | +-------------|-------------------------|-----------|---|---|-------------+       | | | |   |   |       | |         | |   |     | | +-|---+ | |   +-+ | |   |   | | | |   ",
"     | |   | | | | |   | |   | |         |   | |     |       | |       |           | | |   |             |       | | | |   |   |       | |         | |   |     | | | |   | | |   | | | |   |   | | | |   ",
"     | |   | | | | |   | |   | | +-------+   | |     |       | |       |           | | |   |             |       +-|-|-|---------------|-------+   | |   |     | | | |   | | |   | +---------+ | | | |   ",
"     | |   | | | | |   | |   | | |           | |     |       | |       |           | | |   |             |         | | |   |   |       | |     |   | |   |     | | | |   | | |   |   | |   | | | | | |   ",
"     | |   | | | | |   | |   | | |       +---|-------------------------------------|-------------------------------|---|---------------|-|---------|-----------------+   | | |   |   | |   | | | | | |   ",
"     | |   | | | | |   | |   | | |       |   | |     |       | |       |           | | |   |             |         | | |   |   |       | |     |   | |   |     | | |     | | |   |   | |   | | | | | |   ",
" +---|-|-----|-|-------------|-|-|-------------+     |       | |       +-------------|-|-----------------|-----------|-----+   |       | |     |   | |   |     | | |   +-|---|---|---|-|-----+ | | | |   ",
" |   | |   | | | | |   | |   | | |       |   |       |       | |                   | | |   |             |         | | |       |       | |     |   | |   |     | | |   | | | |   |   | |   |   | | | |   ",
" |   | |   | +---|-|-----------+ |       |   |       |       | |                   | | |   |             |         +---|-----------------|---------|-+   |   +-----------+ | |   |   | |   |   | | | |   ",
" |   | |   |   | | |   | |   |   |       |   |       |       | |                   | | |   |             |           | |       |       | |     |   |     |   | | | |   |   | |   |   | |   |   | | | |   ",
" |   | |   |   | | +-+ | |   |   |       |   |       |       | |                   | | |   |             |           | |       |       | |     |   |     |   | | | |   |   | |   |   | |   +---|-|---+   ",
" |   | |   |   | |   | | |   |   |       |   |       |       | |                   | | |   |             |           | |       |       | |     |   |     |   | | | |   |   | |   |   | |       | | |     ",
" |   | |   |   | |   | | |   |   |       |   |       |       | |                   +-|-|---|-------------|-----------|-----------------|-|---------|---------|-----|---------|-------|---------|-+ |     ",
" |   | |   |   | |   | | |   |   |       |   |       |       | |                     | |   |             |           | |       |       | |     |   |     |   | | | |   |   | |   |   | |       |   |     ",
" |   | |   |   | |   | | |   |   |       |   |       |       | |                     | |   |             |           | +-------|-------------------------+   | | | |   |   | |   |   | |       |   |     ",
" |   | |   |   | |   | | |   |   |       |   |       |       | |                     | |   |             |           |         |       | |     |   |         | | | |   |   | |   |   | |       |   |     ",
" |   | |   |   | |   | | |   |   |       +-------------------|-|---------------------|---------------------------------------+ |       | |     |   | +-------------------+ | |   |   | |       |   |     ",
" |   | |   |   | |   | | |   |   |           |       |       | |                     | |   |             |           |       | |       | |     |   | |       | | | |   | | | |   |   | |       |   |     ",
" |   | |   |   | |   | | |   |   |           |       |       +-+                     | |   |             |           |       | |       | |     |   | |       | | | |   | | | |   |   | |       |   |     ",
" |   | |   |   | |   | | |   |   |           |       |                               | |   |             |           |       | |       | |     |   | |       | | | |   | | | |   |   | |       |   |     ",
" |   | |   |   | |   +---|---|-----------------------+                               | |   |             |           |   +-----|-------|-------|---|-+       | | | |   +-|-+ +-------|-|-+     +---|-+   ",
" |   | |   |   | |     | |   |   |           |                                       | |   |             |           |   |   | |       | |     |   |         | | | |     |       |   | | |         | |   ",
" +-----+   |   | |     | |   |   |           |                                       | |   |             |           |   +---|-|-------|-----------+ +-+     | | | |     +-----+ +---|-|-+         | |   ",
"     |     |   | |     | |   |   |           |                                       | |   |             |           |       | |       | |     |     | |     | | | |           |     | |           | |   ",
"     +---------+ |     +-----|---|---------------------------------------------------------|-------------|-----------|---------|---------------|---------------|---------------|-----|-+           | |   ",
"           |     |       |   |   |           |                                       | |   |             |           |       | |       | |     |     | |     | | | |           |     |             | |   ",
"           |     |       |   |   |           |                     +-----------------|-----|-----+       |           |       | |       +-|-----|-----|-+     +-+ | |           |     +---------------|-+ ",
"           |     |       |   |   |           |                     |                 | |   |     |       |           |       | |         |     |     |           | |           |                   | | | ",
"           |     |       |   |   |           +---------------------|-------------------|---|-------------|-----------|---------|---------+     |     |         +-------------+ |                   | | | ",
"           |     |       |   |   |                                 |                 | |   |     |       |           |       | |               |     |         | | |         | |                   | | | ",
"           |     |       +---|---+                                 |                 | |   |     |       |           |       +-|---------------|-----|-----------|-------------------------+       | | | ",
"           |     |           |                                     |                 | |   |     |       |           |         |               |     |         | | |         | |           |       | | | ",
" +---+     |     |           |                                     +-------------------+   |     |       |           +---------+               +-----+         | +-----------+ |           |       | | | ",
" |   |     |     |           |                                                       |     |     |       |                                                     |   |           |           |       | | | ",
" |   |     |     +-----------|-------------------------------------------------------------------+       +-----------------------------------------------------+   +-----------+           +-------+ | | ",
" |   |     |                 |                                                       |     |                                                                                                         | | ",
" +---|-----|-----------------+                                                       |     +-----------------------------------------------------------------------------------------------------------+ ",
"     |     |                                                                         |                                                                                                               |   ",
"     +-----+                                                                         +---------------------------------------------------------------------------------------------------------------+   ",
                                                                                                                                                                                                         
]
areaExample = [
"     |          ",
"     |  +--+    ",
"     A  |  C    ",
" F---|--|-E---+ ",
"     |  |  |  D ",
"     +B-+  +--+ ",
]

y, x = 0, area[0].find("|")
yV, xV = 1, 0

letters = []
steps = 0
while area[y][x] != " ":
    y += yV
    x += xV

    if y < 0 or x < 0 or y >= len(area) or x >= len(area[0]):
        break

    steps += 1

    if area[y][x] != "|" and area[y][x] != "+" and area[y][x] != "-":
        letters.append(area[y][x])

    if area[y][x] == "+":
        if yV != 0:
            yV = 0
            if area[y][x-1] != " ":
                xV = -1
            else:
                xV = 1
        else:
            xV = 0
            if area[y-1][x] != " ":
                yV = -1
            else:
                yV = 1

print(''.join(letters), steps)